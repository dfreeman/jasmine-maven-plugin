<!DOCTYPE HTML>
<html lang="ru-RU">
<head>
  <meta charset="UTF-8">
  <title>jasmine-maven-plugin</title>

  <link href='http://fonts.googleapis.com/css?family=Ubuntu:700&subset=latin' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Nobile:400,400italic,700,700italic' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" type="text/css" href="css/jasmine-maven-plugin.css" />

  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.14/jquery-ui.min.js"></script>
  <script type="text/javascript" src="js/vendor/underscore-min.js"></script>
  <script type="text/javascript" src="js/jasmine-maven-plugin.js"></script>
</head>
<body>
  <div class="big title">jasmine-maven-plugin</div>
  <div class="section">
    <ul class="links">
      <li><a href="https://github.com/searls/jasmine-maven-plugin">github</a></li>
      •
      <li><a href="https://github.com/pivotal/jasmine/wiki">Jasmine docs</a></li>
      •
      <li><a href="http://jashkenas.github.com/coffee-script/">CoffeeScript docs</a></li>
      •
      <li><a href="http://try-jasmine.heroku.com">try Jasmine in your browser</a></li>
    </ul>
  </div>
  <div class="section">
    <span class="title">what have we here?</span>
    <p>
      As one might intuit, the jasmine-maven-plugin is a <a href="http://maven.apache.org/">Maven</a> <a href="http://maven.apache.org/guides/mini/guide-configuring-plugins.html">plugin</a> for the JavaScript testing framework, <a href="http://pivotal.github.com/jasmine/">Jasmine</a>.
    </p>
    <p>
      If you're using Maven, you're probably writing Java (but, hey, you could be using it for <a href="http://polyglot.sonatype.org/index.html">any JVM-language</a>). And if you're anything like me, you're here to figure out how to treat your client-side code with the same degree of professionalism that you already show server-side code. Maybe that means you want a painless way to <a href="http://en.wikipedia.org/wiki/Test-driven_development">test-drive</a> your JavaScript. Maybe you're trying to figure out how to incorporate JavaScript tests on your <a href="http://jenkins-ci.org/">continuous integration server</a> without requiring any <a href="http://seleniumhq.org/">browser shenanigans</a>.
    </p>
    <span class="title">the good news</span>
    <ul>
      <li>it helps you practice TDD/BDD as you write JavaScript</li>
      <li>it can run as part of your build with no added configuration on your part</li>
      <li>it has full-on support for the burgeoning <a href="http://jashkenas.github.com/coffee-script/">CoffeeScript</a> language! Any files with a ".coffee" extension will be compiled just in time for your specs to run</li>
  </div>
  <div class="section">
    <span class="title">the 30 second version</span>
    <p>First run this:</p>
    <pre class="terminal"><code>
mvn archetype:generate -DarchetypeRepository=http://searls-maven-repository.googlecode.com/svn/trunk/snapshots -DarchetypeGroupId=com.github.searls -DarchetypeArtifactId=jasmine-archetype -DarchetypeVersion=1.1.0.1-SNAPSHOT -DgroupId=com.acme -DartifactId=my-jasmine-project -Dversion=0.0.1-SNAPSHOT
    </code></pre>
    <p>And then this:</p>
    <pre class="terminal"><code>
cd my-jasmine-project && mvn jasmine:bdd
    </code></pre>
    <p>Then go <a href="http://localhost:8234" target="new">here</a> and you should see:</p>
    <img width="928" height="580" src="img/archetype.png"/>
  </div>
  <div class="section">
    <span class="title">adding it to your project</span>
    <div class="heads-up expandable">
      <p>Long-time user of the plugin? I suggest you take a second-look at your POM configuration. <a href="#" class="show-more">Click here</a> for some details.</p>
      <div class="more">
        <ul>
          <li>
            Your <code>&lt;configuration/&gt;</code> element should rest directly underneath your <code>&lt;plugin/&gt;</code> element (as opposed to under an <code>&lt;execution/&gt;</code>). Otherwise your configuration will be invisible when you run <code>jasmine:XXX</code> goals from the command line.
            I learned this the <a href="http://stackoverflow.com/questions/6560904/why-might-my-maven-mojo-lose-its-configuration-properties-when-run-individually">hard way</a>, just for you.
          </li>
          <li>
            Your plugin configuration's <code>&lt;goals/&gt;</code> should only specify the <code>test</code> goal. The <code>generateManualRunner</code>, <code>prepareResources</code>, and <code>prepareTestResources</code> goals will now fire on their own when they need to. Leaving them in there will at best cause them to run twice, and at worst break with a subsequent release.
          </li>
          <li>
            If you're relying on the <code>preparePackage</code> goal, might I suggest you look into using <a href="http://code.google.com/p/wro4j/">wro4j</a>? Packing JS for distribution is really outside of the plugin's focus, and it's never done a good job of   it. As of <code>1.0.2-beta-4</code>, the <code>preparePackage</code> goal is deprecated.
          </li>
        </ul>
      </div>
    </div>
    <p>
      If you're already familiar with adding Maven plugins to <a href="http://maven.apache.org/guides/introduction/introduction-to-the-pom.html">POM files</a>, then this should be a breeze. If it's new to you, then take a deep breath and contemplate adding this XML to your project's "<code>pom.xml</code>" file:
      <pre><code>
  &lt;build&gt;
    &hellip;
    &lt;plugins&gt;
      &hellip;
      &lt;plugin&gt;
        &lt;groupId&gt;com.github.searls&lt;/groupId&gt;
        &lt;artifactId&gt;jasmine-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;1.1.0&lt;/version&gt;
        &lt;extensions&gt;true&lt;/extensions&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;goals&gt;
              &lt;goal&gt;test&lt;/goal&gt;
            &lt;/goals&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
        &lt;configuration&gt;
          &lt;!-- configuration properties will go here --&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
      &hellip;
    &lt;/plugins&gt;
    &hellip;
  &lt;/build&gt;
      </code></pre>
    </p>
  </div>
  <div class="section">
    <span class="title">writing Jasmine specs</span>
    <p>Ready to try it out? Once you've added the plugin to your project, just run the following in a terminal:</p>
    <pre class="terminal"><code>
mvn jasmine:bdd
    </code></pre>
    <p>You should see some output like this</p>
    <pre class="terminal"><code>
[INFO]

Server started--it's time to spec some JavaScript! You can run your
 specs as you develop by visiting this URL in a web browser:

  http://localhost:8234

The server will monitor these two directories for scripts
 that you add, remove, and change:

  source directory: src/main/javascript

  spec directory: src/test/javascript

Just leave this process running as you test-drive your code,
refreshing your browser window to re-run your specs.
You can kill the server with Ctrl-C when you're done.
    </code></pre>
    <p>Now visit <a href="http://localhost:8234" target="new">http://localhost:8234</a> in your browser of choice and you should see a Jasmine spec runner with 0 specs, 0 failures. Sort of like this one:</p>
    <img src="img/empty.png" width="764" height="462" />
    <p>
      And that's it! When you add source scripts to the source directory and spec scripts to the specs directory and refresh the page, your specs will be executed.
    </p>
    <p>
      Running the <code>jasmine:bdd</code> goal and refreshing an actual browser will always provide substantially faster feedback than the headless <code>jasmine:test</code> goal. As a result, I strongly recommend you use it to drive development of your JavaScript and only worry about running the headless execution when you would otherwise perform full Maven builds (like before you push your code or in CI).
    </p>
  </div>
  <div class="section">
    <span class="title">running a build</span>
    <p>If you've added the plugin as shown above (that is, with an execution of the <code>test</code> goal) to your POM, it's already set up execute your Jasmine specs every time your build goes through the test <a href="http://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html">lifecycle phase</a>!</p>
    <p>So when you run this:</p>
    <pre class="terminal"><code>
mvn clean test
    </code></pre>
    <p>A happy build might output:</p>
    <pre class="terminal"><code>
[INFO] Executing Jasmine Specs
[INFO]
-------------------------------------------------------
 J A S M I N E   S P E C S
-------------------------------------------------------
[INFO]
the ElementMover object
  instantiation
    throws an exception if you forget "new"
  moving around two divs
    initially sees that div1 is above div2
    moves div1 after div2
    moves div2 before div1
    adding a third div to the mix
      moves div1 betwixt div2 &amp; div3
      moves div3 before div1

Results: 6 specs, 0 failures

[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 4.607s
[INFO] Finished at: Mon Jul 04 15:01:58 EDT 2011
[INFO] Final Memory: 9M/81M
[INFO] ------------------------------------------------------------------------
    </code></pre>
    <p>And a failing build might output:</p>
    <pre class="terminal"><code>
[INFO] Executing Jasmine Specs
[INFO]
-------------------------------------------------------
 J A S M I N E   S P E C S
-------------------------------------------------------
[INFO]
HelloWorld
  should say hello
  wins
  wins
  wins
  loses &lt;&lt;&lt; FAILURE!
    * Expected 'sad' to be 'panda'.

1 failure:

  1.) HelloWorld it loses &lt;&lt;&lt; FAILURE!
    * Expected 'sad' to be 'panda'.

Results: 5 specs, 1 failures

[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 4.020s
[INFO] Finished at: Mon Jul 04 15:03:47 EDT 2011
[INFO] Final Memory: 8M/81M
[INFO] ------------------------------------------------------------------------
    </code></pre>
    <p>The plugin relies on <a href="http://htmlunit.sourceforge.net/">HtmlUnit</a> for headless (which is to say, GUI-less) execution. It's not a perfect emulation of a browser, but for moderately well-isolated unit testing (e.g. only pedestrian interactions with the DOM), it works really well.</p>
  </div>
  <div class="section wide">
    <span class="title">tailoring it</span>
    <p>
      The plugin makes numerous assumptions about how you've structured your project. To compensate for the fact that its defaults won't suit your project perfectly, it comes with a (confusingly vast) array of configuration properties. While you can find all of the properties in the project's <a href="https://github.com/searls/jasmine-maven-plugin/blob/master/src/main/java/com/github/searls/jasmine/AbstractJasmineMojo.java">source code</a>, here are some of the popular ones.
    </p>
    <p>(Also: for help seeing how these and other properties might be used, you can <a href="https://github.com/searls/jasmine-maven-plugin/tree/master/src/test/resources/examples">find a number of example projects</a> in the project's github repo, which are used to support its <a href="http://cukes.info/">Cucumber</a> features.)</p>
    <table>
      <thead>
        <tr>
          <th>name</th>
          <th>purpose</th>
          <th>default</th>
          <th>notes</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>sourceIncludes</td>
          <td>an ordered list of filters to match script source files</td>
          <td>[**/*.js, **/*.coffee]</td>
          <td>Often, you'll want to use <code>sourceIncludes</code> to control the ordering of your sources. If your external dependencies need to be loaded first, you might:
            <pre><code>
&lt;sourceIncludes&gt;
  &lt;include&gt;vendor/**/*.js&lt;/include&gt;
  &lt;include&gt;myBootstrapFile.js&lt;/include&gt;
  &lt;include&gt;**/*.js&lt;/include&gt;
  &lt;include&gt;**/*.coffee&lt;/include&gt;
&lt;/sourceIncludes&gt;
            </code></pre>
          </td>
        </tr>
        <tr>
          <td>specIncludes</td>
          <td>an ordered list of filters to match script spec files</td>
          <td>[**/*.js, **/*.coffee]</td>
          <td>I often find myself needing control of the spec include order when I have some global spec helpers or spec-scoped dependencies, like:
            <pre><code>
&lt;specIncludes&gt;
  &lt;include&gt;jasmine-jquery.js&lt;/include&gt;
  &lt;include&gt;spec-helper.js&lt;/include&gt;
  &lt;include&gt;**/*.js&lt;/include&gt;
  &lt;include&gt;**/*.coffee&lt;/include&gt;
&lt;/specIncludes&gt;
            </code></pre>
            </td>
        </tr>
        <tr>
          <td>jsSrcDir</td>
          <td>directory storing your JavaScript</td>
          <td><code>src/main/javascript</code></td>
          <td>serving a Java webapp? You might set this to "<code>${project.basedir}/src/main/webapp/js</code>"</td>
        </tr>
        <tr>
          <td>serverPort</td>
          <td>the port that the <code>jasmine:bdd</code> goal binds to</td>
          <td>8234</td>
          <td></td>
        </tr>
        <tr>
          <td>skipTests</td>
          <td>when true, specs won't be executed during the build</td>
          <td>false</td>
          <td>will most likely come in handy when set on the command line, like so: <code>mvn package -DskipTests</code></td>
        </tr>
        <tr>
          <td>format</td>
          <td>the style with which the plugin outputs results during the build</td>
          <td><code>documentation</code></td>
          <td>setting this to "<code>progress</code>" will print your specs in a much more succinct "<code>....FF..</code>" style</td>
        </tr>
        <tr>
          <td>sourceExcludes</td>
          <td>just like sourceIncludes, but will exclude anything matching the provided patterns</td>
          <td>(none)</td>
          <td></td>
        </tr>
        <tr>
          <td>specExcludes</td>
          <td>just like specIncludes, but will exclude anything matching the provided patterns</td>
          <td>(none)</td>
          <td></td>
        </tr>
        <tr>
          <td>jsTestSrcDir</td>
          <td>directory storying your Jasmine Specs</td>
          <td><code>src/test/javascript</code></td>
          <td></td>
        </tr>
        <tr>
          <td>browserVersion</td>
          <td>the type of browser <a href="http://htmlunit.sourceforge.net/">HtmlUnit</a> emulates when your specs run during the build</td>
          <td><code>FIREFOX_3</code></td>
          <td>valid values also include: <code>FIREFOX_3_6, INTERNET_EXPLORER_6, INTERNET_EXPLORER_7, INTERNET_EXPLORER_8</code></td>
        </tr>
        <tr>
          <td>haltOnFailure</td>
          <td>when true, failing specs break the build</td>
          <td>true</td>
          <td>you might want to set this to false temporarily when you have a known failing spec but you don't want to turn off spec execution altogether.</td>
        </tr>
        <tr>
          <td>customRunnerTemplate</td>
          <td>an HTML file that defines how the spec runner pages are rendered</td>
          <td></td>
          <td>for an example, consider starting from the plugin's <a href="https://github.com/searls/jasmine-maven-plugin/blob/master/src/main/resources/jasmine-templates/SpecRunner.htmltemplate">default template</a>.</td>
        </tr>
        <tr>
          <td>preloadSources</td>
          <td>a list of relative-paths to scripts that need to be loaded before any others.</td>
          <td></td>
          <td>this property is only rarely neceesary. It might help in a situation where a spec file needs to be loaded <em>above</em> production sources, or when a remote dependency needs to be included (ex. <code>&lt;preloadSources&gt;&lt;source&gt;http://a.com/lib.js&lt;/source&gt;&lt;/preloadSources&gt;</code>)</td>
        </tr>
        <tr>
          <td>timeout</td>
          <td>when spec execution exceeds the timeout (in seconds), the build fails</td>
          <td>300</td>
          <td>if you have a lot of specs or if you're using Jasmine for integration testing, you may find that you need to increase this limit.</td>
        </tr>
        <tr>
          <td>junitXmlReportFileName</td>
          <td>the name of the generated JUnit XML report</td>
          <td>TEST-jasmine.xml</td>
          <td>the plugin generates XML of the same brand JUnit does; this is handy for when your CI server is capable of aggregating these XML files (like Jenkins freestyle projects)</td>
        </tr>
      </tbody>
    </table>
  </div>

</body>
</html>